<template>
  <div class="container">
    <!-- ä¸»æ¨™é¡Œå€åŸŸ -->
    <div class="header">
      <h1 class="main-title">ğŸŠ å©šç¦®ç¥ç¦ç‰†</h1>
      <p class="subtitle">æ­¡è¿ä¸Šå‚³ç…§ç‰‡æˆ–ç•™è¨€ç¥ç¦ï¼Œç‚ºæˆ‘å€‘ç•™ä¸‹ç¾å¥½å›æ†¶</p>
    </div>

    <!-- å°èˆªå€åŸŸ -->
    <div class="navigation">
      <el-row :gutter="16" justify="center">
        <el-col :span="6">
          <el-card shadow="hover" class="nav-card" @click="navigateTo('/wall')">
            <div class="nav-content">
              <el-icon size="32" class="nav-icon">
                <Picture />
              </el-icon>
              <h3>ç¥ç¦ç‰†</h3>
              <p>ç¶“å…¸ç‰ˆè¼ªæ’­</p>
            </div>
          </el-card>
        </el-col>
        <el-col :span="6">
          <el-card shadow="hover" class="nav-card styles-card" @click="navigateTo('/wall-styles')">
            <div class="nav-content">
              <el-icon size="32" class="nav-icon">
                <MagicStick />
              </el-icon>
              <h3>é¢¨æ ¼ç¥ç¦ç‰†</h3>
              <p>å¤šç¨®ç²¾ç¾é¢¨æ ¼</p>
              <el-tag type="warning" size="small" class="new-tag">HOT</el-tag>
            </div>
          </el-card>
        </el-col>
        <el-col :span="6">
          <el-card shadow="hover" class="nav-card" @click="navigateTo('/gallery')">
            <div class="nav-content">
              <el-icon size="32" class="nav-icon">
                <PhotoIcon />
              </el-icon>
              <h3>ç›¸ç°¿</h3>
              <p>ç€è¦½æ‰€æœ‰ç…§ç‰‡</p>
            </div>
          </el-card>
        </el-col>
        <el-col :span="6">
          <el-card shadow="hover" class="nav-card" @click="navigateTo('/upload')">
            <div class="nav-content">
              <el-icon size="32" class="nav-icon">
                <Upload />
              </el-icon>
              <h3>ä¸Šå‚³ç¥ç¦</h3>
              <p>ç•™ä¸‹ç¾å¥½å›æ†¶</p>
            </div>
          </el-card>
        </el-col>
      </el-row>
      
      <!-- é¢¨æ ¼å¿«æ·æŒ‰éˆ• -->
      <div class="quick-styles">
        <el-divider>
          <span class="divider-text">ğŸ¨ å¿«é€Ÿé«”é©—é¢¨æ ¼</span>
        </el-divider>
        
        <el-row :gutter="12" justify="center">
          <el-col :span="6">
            <el-button 
              type="primary" 
              @click="navigateTo('/wall-enhanced')"
              class="style-quick-btn"
            >
              <el-icon><Star /></el-icon>
              Instagram
            </el-button>
          </el-col>
          <el-col :span="6">
            <el-button 
              type="success" 
              @click="navigateTo('/wall-stories')"
              class="style-quick-btn"
            >
              <el-icon><VideoCamera /></el-icon>
              Stories
            </el-button>
          </el-col>
          <el-col :span="6">
            <el-button 
              type="info" 
              @click="navigateTo('/wall-magazine')"
              class="style-quick-btn"
            >
              <el-icon><Document /></el-icon>
              Magazine
            </el-button>
          </el-col>
          <el-col :span="6">
            <el-button 
              type="warning" 
              @click="navigateTo('/wall-polaroid')"
              class="style-quick-btn"
            >
              <el-icon><Picture /></el-icon>
              Polaroid
            </el-button>
          </el-col>
        </el-row>
      </div>
    </div>

    <!-- èƒŒæ™¯åœ–ç‰‡è¨­å®šå€åŸŸ -->
    <div class="background-section">
      <BackgroundUpload />
    </div>

    <!-- ç¥ç¦ç‰†è¨­å®šå€åŸŸ -->
    <div class="settings-section">
      <WallSettings />
    </div>
    
    <!-- ç¥ç¦ç‰†æ¨™é¡Œè¨­å®šå€åŸŸ -->
    <div class="title-settings-section">
      <WallTitleSettings />
    </div>

    <!-- èªè­‰ç™»å…¥å€åŸŸ -->
    <div class="auth-section">
      <el-divider>
        <span class="divider-text">ğŸ’Œ é–‹å§‹ç•™ä¸‹ç¥ç¦</span>
      </el-divider>
      <div class="auth-hint">
        <p>é»æ“Šä¸Šæ–¹ã€Œä¸Šå‚³ç¥ç¦ã€æŒ‰éˆ•ï¼Œå¡«å¯«å§“åä¸¦ç•™ä¸‹ç¾å¥½ç¥ç¦ï¼</p>
      </div>
    </div>

    <!-- ç‰¹è‰²èªªæ˜ -->
    <div class="features">
      <el-row :gutter="20">
        <el-col :span="8">
          <div class="feature-item">
            <el-icon size="24" color="#409EFF">
              <Upload />
            </el-icon>
            <h4>ä¸Šå‚³ç…§ç‰‡</h4>
            <span>åˆ†äº«ç¾å¥½ç¬é–“</span>
          </div>
        </el-col>
        <el-col :span="8">
          <div class="feature-item">
            <el-icon size="24" color="#67C23A">
              <ChatDotRound />
            </el-icon>
            <h4>ç•™è¨€ç¥ç¦</h4>
            <span>å‚³é”æº«é¦¨å¿ƒæ„</span>
          </div>
        </el-col>
        <el-col :span="8">
          <div class="feature-item">
            <el-icon size="24" color="#E6A23C">
              <Star />
            </el-icon>
            <h4>å³æ™‚å±•ç¤º</h4>
            <span>è‡ªå‹•è¼ªæ’­é¡¯ç¤º</span>
          </div>
        </el-col>
      </el-row>
    </div>
  </div>
</template>

<script setup lang="ts">
import BackgroundUpload from '~/components/BackgroundUpload.vue'
import WallSettings from '~/components/WallSettings.vue'
import WallTitleSettings from '~/components/WallTitleSettings.vue'
import { Picture, Upload, ChatDotRound, Star, MagicStick, VideoCamera, Document } from '@element-plus/icons-vue'

// ä½¿ç”¨ Pinia Stores
const backgroundStore = useBackgroundStore()
const uiStore = useUIStore()

// å®šç¾© PhotoIcon çµ„ä»¶
const PhotoIcon = {
  name: 'PhotoIcon',
  render() {
    return h('svg', {
      viewBox: '0 0 1024 1024',
      width: '1em',
      height: '1em',
      fill: 'currentColor'
    }, [
      h('path', {
        d: 'M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zM896 792H128V224h768v568zM304 456a88 88 0 1 0 0-176 88 88 0 0 0 0 176zm0-116c15.5 0 28 12.5 28 28s-12.5 28-28 28-28-12.5-28-28 12.5-28 28-28zm462.2 195.2L730.7 487c-5.7-6.8-14.1-11-23-11s-17.3 4.2-23 11l-104.6 125.5-80.4-96.5c-5.7-6.8-14.1-11-23-11s-17.3 4.2-23 11L370.2 632.9c-11.7 14-2.9 35.1 14.8 35.1h457c17.7 0 26.5-21.1 14.8-35.1z'
      })
    ])
  }
}

// è¨­å®šé é¢ meta
useHead({
  title: 'å©šç¦®ç¥ç¦ç‰† - ç•™ä¸‹ç¾å¥½å›æ†¶',
  meta: [
    { name: 'description', content: 'æ­¡è¿ä¾†åˆ°å©šç¦®ç¥ç¦ç‰†ï¼Œä¸Šå‚³ç…§ç‰‡å’Œç•™è¨€ç¥ç¦ï¼Œèˆ‡æ–°äººåˆ†äº«é€™å€‹ç‰¹åˆ¥çš„æ™‚åˆ»ï¼' }
  ]
})

// åˆå§‹åŒ–é é¢
onMounted(() => {
  // è¨­å®šç•¶å‰é é¢
  uiStore.setCurrentPage('home')
  
  // å¼·åˆ¶å¾ MinIO é‡æ–°å–å¾—èƒŒæ™¯åœ–ï¼Œç¢ºä¿èˆ‡ä¼ºæœå™¨ç‹€æ…‹åŒæ­¥
  backgroundStore.loadBackground(true)
  
  // ç›£è½é é¢é¡¯ç¤ºäº‹ä»¶ï¼ˆå¾å…¶ä»–é é¢è¿”å›æ™‚é‡æ–°è¼‰å…¥ï¼‰
  const handleVisibilityChange = () => {
    if (!document.hidden) {
      // é é¢é‡æ–°é¡¯ç¤ºæ™‚å¼·åˆ¶é‡æ–°è¼‰å…¥èƒŒæ™¯
      backgroundStore.loadBackground(true)
    }
  }
  
  document.addEventListener('visibilitychange', handleVisibilityChange)
  
  // ç›£è½é é¢ç„¦é»äº‹ä»¶
  const handleFocus = () => {
    backgroundStore.loadBackground(true)
  }
  
  window.addEventListener('focus', handleFocus)
  
  // æ¸…ç†äº‹ä»¶ç›£è½å™¨
  onUnmounted(() => {
    document.removeEventListener('visibilitychange', handleVisibilityChange)
    window.removeEventListener('focus', handleFocus)
  })
})
</script>

<style scoped>
.container {
  max-width: 800px;
  margin: 0 auto;
  padding: 2rem 1rem;
  min-height: calc(100vh - 80px);
}

/* ä¸»æ¨™é¡Œå€åŸŸ */
.header {
  text-align: center;
  margin-bottom: 3rem;
}

.main-title {
  font-size: 2.5rem;
  font-weight: bold;
  color: #2c3e50;
  margin-bottom: 1rem;
  text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
}

.subtitle {
  font-size: 1.1rem;
  color: #7f8c8d;
  margin-bottom: 0;
  line-height: 1.6;
}

/* å°èˆªå€åŸŸ */
.navigation {
  margin-bottom: 3rem;
}

.nav-card {
  cursor: pointer;
  transition: all 0.3s ease;
  border-radius: 12px;
  border: 2px solid transparent;
}

.nav-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 8px 25px rgba(0,0,0,0.15);
  border-color: #409EFF;
}

.nav-card.styles-card {
  background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
  color: white;
  position: relative;
  overflow: hidden;
}

.nav-card.styles-card::before {
  content: '';
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
  transform: rotate(45deg);
  animation: shimmer 3s infinite;
}

.nav-card.styles-card .nav-icon {
  color: #FFD700;
}

.nav-card.styles-card .nav-content h3 {
  color: white;
}

.nav-card.styles-card .nav-content p {
  color: rgba(255,255,255,0.9);
}

.nav-card.enhanced {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  position: relative;
  overflow: hidden;
}

.nav-card.enhanced::before {
  content: '';
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
  transform: rotate(45deg);
  animation: shimmer 3s infinite;
}

@keyframes shimmer {
  0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
  100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
}

.nav-card.enhanced .nav-icon {
  color: #FFD700;
}

.nav-card.enhanced .nav-content h3 {
  color: white;
}

.nav-card.enhanced .nav-content p {
  color: rgba(255,255,255,0.9);
}

.new-tag {
  position: absolute;
  top: 10px;
  right: 10px;
  z-index: 2;
}

.nav-content {
  text-align: center;
  padding: 1rem 0;
}

.nav-icon {
  color: #409EFF;
  margin-bottom: 0.5rem;
}

.nav-content h3 {
  margin: 0.5rem 0 0.25rem 0;
  color: #2c3e50;
  font-weight: 600;
}

.nav-content p {
  margin: 0;
  color: #7f8c8d;
  font-size: 0.9rem;
}

/* èƒŒæ™¯è¨­å®šå€åŸŸ */
.background-section {
  margin-bottom: 2rem;
}

/* ç¥ç¦ç‰†è¨­å®šå€åŸŸ */
.settings-section {
  margin-bottom: 2rem;
}

/* èªè­‰å€åŸŸ */
.auth-section {
  margin-bottom: 3rem;
}

.divider-text {
  color: #2c3e50;
  font-weight: bold;
  font-size: 1.2rem;
  padding: 0 1rem;
  text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
}

.auth-hint {
  text-align: center;
  margin-top: 1rem;
}

.auth-hint p {
  color: #7f8c8d;
  font-size: 1rem;
  margin: 0;
}

/* ç‰¹è‰²èªªæ˜ */
.features {
  margin-top: 2rem;
}

.feature-item {
  text-align: center;
  padding: 1rem;
  background: rgba(255, 255, 255, 0.8);
  border-radius: 8px;
  margin-bottom: 1rem;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.feature-item h4 {
  margin: 0.5rem 0 0.25rem 0;
  color: #2c3e50;
  font-size: 1rem;
  font-weight: 600;
}

.feature-item span {
  color: #7f8c8d;
  font-size: 0.85rem;
}

/* å¿«é€Ÿé¢¨æ ¼æŒ‰éˆ•å€åŸŸ */
.quick-styles {
  margin-top: 2rem;
  padding-top: 1rem;
}

.style-quick-btn {
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  font-size: 0.9rem;
  font-weight: 500;
  padding: 10px 8px;
  border-radius: 8px;
  transition: all 0.3s ease;
}

.style-quick-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

/* éŸ¿æ‡‰å¼è¨­è¨ˆ */
@media (max-width: 768px) {
  .container {
    padding: 1rem 0.5rem;
  }
  
  .main-title {
    font-size: 2rem;
  }
  
  .subtitle {
    font-size: 1rem;
  }
  
  .nav-content {
    padding: 0.75rem 0;
  }
  
  .nav-content h3 {
    font-size: 1rem;
  }
  
  .nav-content p {
    font-size: 0.8rem;
  }
  
  .feature-item {
    margin-bottom: 0.75rem;
  }
  
  .style-quick-btn {
    font-size: 0.8rem;
    padding: 8px 6px;
  }
}

@media (max-width: 480px) {
  .main-title {
    font-size: 1.75rem;
  }
  
  .navigation .el-col {
    margin-bottom: 1rem;
  }
  
  .quick-styles .el-col {
    margin-bottom: 0.75rem;
  }
  
  .style-quick-btn {
    font-size: 0.75rem;
    padding: 6px 4px;
  }
}
</style>